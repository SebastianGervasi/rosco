<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rosco de Pasapalabra - Modo Anfitri√≥n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-x: hidden; /* Asegurar que no haya scroll horizontal */
        }

        .container {
            max-width: 1400px;
            width: 100%;
            padding: 20px;
            display: flex; /* A√±adido para centrar el contenido de las pantallas */
            flex-direction: column; /* A√±adido */
            align-items: center; /* A√±adido */
            justify-content: center; /* A√±adido */
        }

        /* Pantalla de configuraci√≥n */
        .setup-screen {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 90%; /* Ajuste para m√≥vil */
            margin: 0 auto;
        }

        .setup-screen h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .setup-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .input-group {
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .start-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .start-btn:hover {
            transform: translateY(-2px);
        }

        /* Pantalla de cuenta regresiva */
        .countdown-screen {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 60px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 400px;
            width: 90%; /* Ajuste para m√≥vil */
            margin: 0 auto;
        }

        .countdown-number {
            font-size: 8em;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
            animation: countdownPulse 1s ease-in-out;
        }

        @keyframes countdownPulse {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .countdown-text {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
        }

        /* Pantalla de juego */
        .game-screen {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%; /* Ocupar todo el ancho disponible */
            max-width: 1200px; /* Limitar el ancho m√°ximo */
            display: flex; /* A√±adido para layout interno */
            flex-direction: column; /* A√±adido */
            align-items: center; /* Centrar contenido */
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
            width: 100%; /* Ocupar todo el ancho */
        }

        .player-info h2 {
            color: #333;
            margin-bottom: 5px;
        }

        .timer {
            font-size: 2.5em;
            font-weight: bold;
            color: #e74c3c;
            background: #f8f9fa;
            padding: 15px 25px;
            border-radius: 15px;
            border: 3px solid #e74c3c;
        }

        .timer.warning {
            animation: pulse 1s infinite;
        }

        .timer.paused {
            color: #ffc107;
            border-color: #ffc107;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .game-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .control-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pause-btn {
            background: #ffc107;
            color: #333;
            border: 2px solid #f39c12;
        }

        .restart-btn {
            background: #6c757d;
            color: white;
            border: 2px solid #545b62;
            display: none;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .game-content {
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 30px;
            align-items: start;
            width: 100%; /* Ocupar todo el ancho */
        }

        /* Rosco circular */
        .rosco-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto;
            display: flex; /* Centrar rosco */
            align-items: center; /* Centrar rosco */
            justify-content: center; /* Centrar rosco */
        }

        .rosco {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            background: #f8f9fa;
            border: 8px solid #333;
        }

        .letter {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e9ecef;
            border: 3px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            transition: all 0.3s;
        }

        .letter.current {
            background: #007bff;
            color: white;
            border-color: #0056b3;
            transform: scale(1.3);
            z-index: 10;
            box-shadow: 0 0 20px rgba(0, 123, 255, 0.5);
        }

        .letter.correct {
            background: #28a745;
            color: white;
            border-color: #1e7e34;
        }

        .letter.incorrect {
            background: #dc3545;
            color: white;
            border-color: #c82333;
        }

        .letter.pasapalabra {
            background: #ffc107;
            color: #333;
            border-color: #f39c12;
        }

        /* Centro del rosco (ya no muestra la pregunta) */
        .rosco-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            background: white;
            border-radius: 50%;
            border: 4px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }

        /* La pregunta ahora se muestra en el host-panel */
        .question-text-display {
            background: #e0f7fa; /* Un color de fondo diferente */
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px; /* Espacio debajo */
            border: 2px solid #00bcd4; /* Borde para destacarlo */
            color: #00796b; /* Color de texto */
            font-size: 1.2em; /* Tama√±o de fuente */
            font-weight: bold;
            text-align: center;
        }


        /* Panel de control del anfitri√≥n */
        .host-panel {
            background: #f8f9fa;
            padding: 20px; /* Aumentado padding */
            border-radius: 15px;
            border: 3px solid #007bff;
            display: flex; /* Para organizar mejor el contenido */
            flex-direction: column; /* Para organizar mejor el contenido */
            align-items: center; /* Centrar elementos internos */
            text-align: center; /* Centrar texto */
        }

        .host-panel h3 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .current-letter-display {
            margin-bottom: 25px;
        }

        .current-letter-display .letter-big {
            font-size: 3em;
            font-weight: bold;
            color: white;
            background: #007bff;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            border: 3px solid #0056b3;
        }

        .answer-display {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 2px solid #2196f3;
            width: 100%; /* Ocupar todo el ancho disponible */
        }

        .answer-display h4 {
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .correct-answer {
            font-size: 1.5em;
            font-weight: bold;
            color: #1976d2;
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 2px solid #2196f3;
            word-wrap: break-word; /* Para respuestas largas */
        }

        .question-type {
            background: #fff3cd;
            color: #856404;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
            border: 1px solid #ffc107;
        }

        .host-controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            width: 100%; /* Asegurar que los botones ocupen el ancho */
        }

        .host-btn {
            padding: 10px 15px; /* Ajuste para mayor √°rea t√°ctil */
            border: none;
            border-radius: 10px;
            font-size: 16px; /* Aumentar tama√±o de fuente */
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            flex-grow: 1; /* Para que los botones se expandan */
            min-width: 100px; /* Ancho m√≠nimo para cada bot√≥n */
            min-height: 50px; /* Altura m√≠nima para cada bot√≥n */
        }

        .host-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        .host-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-correct {
            background: #28a745;
            color: white;
            border: 3px solid #1e7e34;
        }

        .btn-incorrect {
            background: #dc3545;
            color: white;
            border: 3px solid #c82333;
        }

        .btn-pasapalabra {
            background: #ffc107;
            color: #333;
            border: 3px solid #f39c12;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            text-align: center;
            width: 100%; /* Ocupar todo el ancho disponible */
        }

        .stat {
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
        }

        .stat.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }
        .stat.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }
        .stat.pasapalabra {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }

        /* Modal de pausa */
        .pause-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .pause-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            margin: 20px;
            width: 90%; /* Ajuste para m√≥vil */
        }

        .pause-content h2 {
            color: #dc3545;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .wrong-answer {
            font-size: 1.5em;
            color: #dc3545;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            background: #f8d7da;
            border-radius: 10px;
            border: 2px solid #dc3545;
            word-wrap: break-word; /* Para respuestas largas */
        }

        .resume-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }

        /* Pantalla de resultados */
        .results-screen {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%; /* Ocupar todo el ancho disponible */
            max-width: 1200px; /* Limitar el ancho m√°ximo */
            margin: 0 auto;
            text-align: center; /* Centrar contenido */
        }

        .results-header {
            margin-bottom: 30px;
        }

        .results-header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .final-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .final-stat {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            font-weight: bold;
            border: 3px solid;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .results-table th,
        .results-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #ddd;
        }

        .results-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        .results-table tr.correct { background: #d4edda; }
        .results-table tr.incorrect { background: #f8d7da; }
        .results-table tr.pasapalabra { background: #fff3cd; }

        .question-type-cell {
            font-size: 11px;
            color: #666;
            font-style: italic;
        }

        .play-again-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            display: block;
            margin: 0 auto;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .game-content {
                grid-template-columns: 1fr; /* Una sola columna en m√≥vil */
                gap: 25px;
            }

            .rosco-container {
                width: 300px; /* Tama√±o un poco m√°s grande para el rosco en tablets */
                height: 300px;
                order: 2; /* Rosco abajo */
                margin: 20px auto; /* Centrar y dar espacio */
            }

            .host-panel {
                order: 1; /* Panel del anfitri√≥n arriba */
                padding: 15px;
                margin-bottom: 0; /* Sin margen inferior ya que el rosco est√° abajo */
                width: 100%; /* Asegurar que ocupe todo el ancho */
            }

            .letter {
                width: 38px;
                height: 38px;
                font-size: 16px;
                font-weight: bold;
            }

            .rosco-center {
                width: 160px; /* Ajuste para el centro del rosco */
                height: 160px;
                padding: 15px;
            }

            .game-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
                margin-bottom: 20px;
            }

            .timer {
                font-size: 2.2em;
                padding: 12px 20px;
            }

            .countdown-number {
                font-size: 6em;
            }

            .host-btn {
                padding: 8px 12px; /* Ajuste de padding */
                font-size: 14px;
                min-height: 48px; /* Mayor altura para facilitar el toque */
            }

            .control-btn {
                padding: 15px 25px;
                font-size: 18px;
                min-height: 50px;
            }

            .current-letter-display .letter-big {
                width: 70px; /* Tama√±o ajustado */
                height: 70px;
                font-size: 2.5em; /* Tama√±o de fuente ajustado */
            }

            .answer-display {
                padding: 15px;
            }

            .correct-answer {
                font-size: 1.6em;
                padding: 10px;
            }

            .question-text-display { /* Ajuste para la pregunta en el host panel */
                font-size: 1em;
                padding: 10px;
            }

            .question-type {
                font-size: 14px;
                padding: 10px 15px;
            }

            .stats {
                grid-template-columns: repeat(3, 1fr); /* Mantener 3 columnas */
                gap: 8px; /* Reducir gap */
            }

            .stat {
                padding: 10px 5px; /* Ajustar padding */
                font-size: 13px; /* Ajustar fuente */
            }

            /* Mejorar la tabla de resultados en m√≥viles */
            .results-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }

            .results-table thead,
            .results-table tbody,
            .results-table th,
            .results-table td,
            .results-table tr {
                display: block;
            }

            .results-table thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }

            .results-table tr {
                border: 1px solid #ccc;
                margin-bottom: 10px;
                padding: 10px;
                border-radius: 8px;
                background: white;
            }

            .results-table td {
                border: none;
                position: relative;
                padding: 8px 8px 8px 25%;
                white-space: normal;
                text-align: left;
            }

            .results-table td:before {
                content: attr(data-label) ": ";
                position: absolute;
                left: 6px;
                width: 20%;
                padding-right: 10px;
                white-space: nowrap;
                font-weight: bold;
                color: #666;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .setup-screen,
            .game-screen,
            .results-screen,
            .countdown-screen {
                padding: 20px;
                margin: 10px auto; /* Centrar pantallas */
                width: 100%; /* Ocupar todo el ancho */
            }

            .rosco-container {
                width: 250px; /* M√°s peque√±o para m√≥viles */
                height: 250px;
            }

            .letter {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }

            .letter.current {
                transform: scale(1.3);
            }

            .rosco-center {
                width: 120px;
                height: 120px;
                padding: 10px;
            }

            .game-header {
                flex-direction: column;
                gap: 10px;
                margin-bottom: 15px;
            }

            .timer {
                font-size: 1.8em;
                padding: 10px 18px;
            }

            .countdown-number {
                font-size: 4.5em;
            }

            .host-controls {
                gap: 8px;
            }

            .host-btn {
                padding: 6px 10px;
                font-size: 13px;
                min-height: 45px;
                border-radius: 8px;
            }

            .control-btn {
                padding: 12px 20px;
                font-size: 16px;
                min-height: 45px;
            }

            .current-letter-display .letter-big {
                width: 60px;
                height: 60px;
                font-size: 2.2em;
            }

            .correct-answer {
                font-size: 1.3em;
                padding: 8px;
            }

            .question-text-display { /* Ajuste para la pregunta en el host panel */
                font-size: 0.9em;
                padding: 8px;
            }

            .question-type {
                font-size: 12px;
                padding: 8px 12px;
            }

            .input-group input {
                padding: 12px;
                font-size: 16px;
            }

            .start-btn {
                padding: 15px 30px;
                font-size: 18px;
            }

            .setup-screen h1 {
                font-size: 2em;
            }

            .results-table {
                font-size: 12px;
            }

            .results-table th,
            .results-table td {
                padding: 6px 4px;
            }

            .final-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .final-stat {
                padding: 15px 10px;
            }

            .pause-content {
                padding: 25px 20px;
                margin: 15px;
            }

            .wrong-answer {
                font-size: 1.2em;
                padding: 10px;
            }

            .resume-btn {
                padding: 15px 25px;
                font-size: 16px;
            }
        }

        /* Optimizaciones para touch */
        @media (hover: none) and (pointer: coarse) {
            .host-btn:hover,
            .control-btn:hover,
            .start-btn:hover,
            .resume-btn:hover,
            .play-again-btn:hover {
                transform: none;
                box-shadow: none;
            }

            .host-btn:active,
            .control-btn:active,
            .start-btn:active,
            .resume-btn:active,
            .play-again-btn:active {
                transform: scale(0.98);
                transition: transform 0.1s;
            }
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="setup-screen" id="setupScreen">
            <h1>üéØ Rosco de Pasapalabra</h1>
            <h3 style="color: #666; margin-bottom: 30px;">Modo Anfitri√≥n</h3>
            <form class="setup-form" id="setupForm">
                <div class="input-group">
                    <label for="playerName">Nombre del jugador:</label>
                    <input type="text" id="playerName" required placeholder="Ingresa el nombre del jugador">
                </div>

                <div class="input-group">
                    <label for="gameTime">Tiempo de juego (segundos):</label>
                    <input type="number" id="gameTime" value="90" min="30" max="300" required>
                </div>

                <button type="submit" class="start-btn">¬°Comenzar Juego!</button>
            </form>
        </div>

        <div class="countdown-screen" id="countdownScreen">
            <div class="countdown-text">El juego comenzar√° en...</div>
            <div class="countdown-number" id="countdownNumber">3</div>
            <div style="color: #666;">¬°Prep√°rate!</div>
        </div>

        <div class="game-screen" id="gameScreen">
            <div class="game-header">
                <div class="player-info">
                    <h2 id="playerNameDisplay"></h2>
                    <p>Rosco de Pasapalabra - Modo Anfitri√≥n</p>
                </div>
                <div class="game-controls">
                    <button class="control-btn pause-btn" id="pauseBtn">‚è∏ PAUSA</button>
                    <button class="control-btn restart-btn" id="restartBtn">üîÑ REINICIAR</button>
                </div>
                <div class="timer" id="timer">90</div>
            </div>

            <div class="game-content">
                <div class="rosco-container">
                    <div class="rosco" id="rosco">
                        </div>
                    <div class="rosco-center">
                        </div>
                </div>
                <div class="host-panel">
                    <h3>üé§ Panel del Anfitri√≥n</h3>
                    <div class="current-letter-display">
                        <div class="letter-big" id="currentLetterBig">A</div>
                        <p><strong>Letra actual</strong></p>
                    </div>
                    <div class="question-text-display" id="hostQuestionDisplay">
                        ¬°El juego comenzar√° en breve!
                    </div>
                    <div class="answer-display">
                        <div class="question-type" id="questionType">Empieza por la letra</div>
                        <h4>Respuesta correcta:</h4>
                        <div class="correct-answer" id="correctAnswer">-</div>
                    </div>
                    <div class="host-controls">
                        <button class="host-btn btn-correct" id="correctBtn" disabled>‚úì CORRECTA</button>
                        <button class="host-btn btn-incorrect" id="incorrectBtn" disabled>‚úó INCORRECTA</button>
                        <button class="host-btn btn-pasapalabra" id="pasapalabraBtn" disabled>‚è≠ PASAPALABRA</button>
                    </div>
                    <div class="stats">
                        <div class="stat correct">
                            <div>Correctas</div>
                            <div id="correctCount">0</div>
                        </div>
                        <div class="stat incorrect">
                            <div>Incorrectas</div>
                            <div id="incorrectCount">0</div>
                        </div>
                        <div class="stat pasapalabra">
                            <div>Pasapalabra</div>
                            <div id="pasapalabraCount">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="pause-modal" id="pauseModal">
            <div class="pause-content">
                <h2>‚ùå Respuesta Incorrecta</h2>
                <p>La respuesta correcta era:</p>
                <div class="wrong-answer" id="wrongAnswerDisplay"></div>
                <button class="resume-btn" id="resumeBtn">Continuar con la siguiente letra</button>
            </div>
        </div>

        <div class="results-screen" id="resultsScreen">
            <div class="results-header">
                <h1>üèÅ ¬°JUEGO FINALIZADO!</h1>
                <h2 id="finalPlayerName"></h2>
            </div>
            <div class="final-stats">
                <div class="final-stat correct" style="border-color: #28a745;">
                    <h3 id="finalCorrect">0</h3>
                    <p>Correctas</p>
                </div>
                <div class="final-stat incorrect" style="border-color: #dc3545;">
                    <h3 id="finalIncorrect">0</h3>
                    <p>Incorrectas</p>
                </div>
                <div class="final-stat pasapalabra" style="border-color: #ffc107;">
                    <h3 id="finalPasapalabra">0</h3>
                    <p>Pasapalabra</p>
                </div>
                <div class="final-stat" style="background: #e3f2fd; color: #0d47a1; border-color: #2196f3;">
                    <h3 id="finalTime">0</h3>
                    <p>Tiempo usado</p>
                </div>
            </div>
            <div style="overflow-x: auto;">
                <table class="results-table" id="resultsTable">
                    <thead>
                        <tr>
                            <th>Letra</th>
                            <th>Tipo</th>
                            <th>Pregunta</th>
                            <th>Respuesta Correcta</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody">
                        </tbody>
                </table>
            </div>
            <button class="play-again-btn" onclick="location.reload()">Jugar de Nuevo</button>
        </div>
    </div>
    <script>
        // Configuraci√≥n del juego
        let gameConfig = {
            playerName: '',
            gameTime: 90
        };

        // Estado del juego
        let gameState = {
            currentLetter: 0,
            timeLeft: 90,
            timer: null,
            gameStarted: false,
            gameEnded: false,
            gamePaused: false,
            stats: {
                correct: 0,
                incorrect: 0,
                pasapalabra: 0
            },
            answers: {},
            usedQuestions: new Set() // Para evitar repetir preguntas
        };

        // Banco completo de preguntas del rosco con m√∫ltiples opciones por letra
        const questionBank = {
            'A': [
                { type: 'starts', question: 'Veh√≠culo de motor con cuatro ruedas para el transporte de personas', answer: 'AUTO' },
                { type: 'starts', question: 'L√≠quido transparente e incoloro que bebemos', answer: 'AGUA' },
                { type: 'starts', question: 'Ave rapaz de gran tama√±o que vuela muy alto', answer: 'AGUILA' },
                { type: 'contains', question: 'Instrumento musical de cuerda que se toca con los dedos', answer: 'GUITARRA' },
                { type: 'contains', question: 'Deporte que se juega en una cancha con una pelota naranja', answer: 'BALONCESTO' },
                { type: 'contains', question: 'Animal dom√©stico que ladra', answer: 'PERRO' }
            ],
            'B': [
                { type: 'starts', question: 'Embarcaci√≥n de estructura c√≥ncava y, generalmente, de grandes dimensiones', answer: 'BARCO' },
                { type: 'starts', question: 'Fruto amarillo alargado que comen los monos', answer: 'BANANA' },
                { type: 'starts', question: 'Deporte que se juega con una pelota naranja y dos canastas', answer: 'BALONCESTO' },
                { type: 'contains', question: 'Conjunto de muchas hojas de papel encuadernadas', answer: 'LIBRO' },
                { type: 'contains', question: 'Mueble donde se duerme', answer: 'CAMA' },
                { type: 'contains', question: 'Prenda de vestir que cubre el torso', answer: 'CAMISA' }
            ],
            'C': [
                { type: 'starts', question: 'Animal dom√©stico felino que ma√∫lla', answer: 'GATO' },
                { type: 'starts', question: 'Veh√≠culo de cuatro ruedas movido por motor', answer: 'COCHE' },
                { type: 'starts', question: 'Edificio donde vive una familia', answer: 'CASA' },
                { type: 'contains', question: 'Instrumento para escribir con tinta', answer: 'LAPICERO' },
                { type: 'contains', question: 'Deporte que se juega con los pies', answer: 'FUTBOL' },
                { type: 'contains', question: 'Aparato para hacer fotograf√≠as', answer: 'C√ÅMARA' }
            ],
            'D': [
                { type: 'starts', question: 'Cada una de las extremidades que tienen los humanos en la boca para masticar', answer: 'DIENTE' },
                { type: 'starts', question: 'Moneda de curso legal', answer: 'DINERO' },
                { type: 'starts', question: 'Per√≠odo de veinticuatro horas', answer: 'D√çA' },
                { type: 'contains', question: 'Lugar donde se estudia', answer: 'CIUDAD' },
                { type: 'contains', question: 'Aparato para escuchar m√∫sica', answer: 'RADIO' },
                { type: 'contains', question: 'Juego de mesa con fichas numeradas', answer: 'DOMINO' }
            ],
            'E': [
                { type: 'starts', question: 'Animal mam√≠fero con trompa muy larga', answer: 'ELEFANTE' },
                { type: 'starts', question: 'Lugar donde se ense√±a y se aprende', answer: 'ESCUELA' },
                { type: 'starts', question: 'Construcci√≥n que tiene varios pisos', answer: 'EDIFICIO' },
                { type: 'contains', question: 'Aparato para subir y bajar entre pisos', answer: 'ASCENSOR' },
                { type: 'contains', question: 'Veh√≠culo de dos ruedas', answer: 'BICICLETA' },
                { type: 'contains', question: 'Deporte que se juega con raqueta', answer: 'TENIS' }
            ],
            'F': [
                { type: 'starts', question: 'Deporte que se juega con los pies y una pelota redonda', answer: 'F√öTBOL' },
                { type: 'starts', question: 'Conjunto de personas que viven juntas', answer: 'FAMILIA' },
                { type: 'starts', question: 'Elemento qu√≠mico que produce llama', answer: 'FUEGO' },
                { type: 'contains', question: 'Aparato para hablar a distancia', answer: 'TEL√âFONO' },
                { type: 'contains', question: 'Profesi√≥n que apaga incendios', answer: 'BOMBERO' },
                { type: 'contains', question: 'Lugar donde se hacen pel√≠culas', answer: 'CINE' }
            ],
            'G': [
                { type: 'starts', question: 'Animal dom√©stico felino que ma√∫lla', answer: 'GATO' },
                { type: 'starts', question: 'Prenda de vestir para las manos', answer: 'GUANTE' },
                { type: 'starts', question: 'Conflicto armado entre pa√≠ses', answer: 'GUERRA' },
                { type: 'contains', question: 'Juego de mesa con fichas blancas y negras', answer: 'AJEDREZ' },
                { type: 'contains', question: 'Instrumento musical de cuerda', answer: 'GUITARRA' },
                { type: 'contains', question: 'Color de la hierba', answer: 'VERDE' }
            ],
            'H': [
                { type: 'starts', question: '√ìrgano que bombea la sangre en el cuerpo', answer: 'CORAZ√ìN' },
                { type: 'starts', question: 'Contiene H: Elemento qu√≠mico esencial para la vida', answer: 'OX√çGENO' },
                { type: 'starts', question: 'Parte de la casa donde se cocina', answer: 'COCINA' },
                { type: 'contains', question: 'Contiene H: Instrumento para medir la temperatura', answer: 'TERM√ìMETRO' },
                { type: 'contains', question: 'Contiene H: Que tiene mucha sed', answer: 'DESHIDRATADO' },
                { type: 'contains', question: 'Contiene H: Un tipo de pan dulce y esponjoso', answer: 'BIZCOCHO' }
            ],
            'I': [
                { type: 'starts', question: 'Pa√≠s en forma de bota, famoso por su pizza', answer: 'ITALIA' },
                { type: 'starts', question: 'Herramienta que sirve para cavar o remover tierra', answer: 'PALA' },
                { type: 'starts', question: 'Pez grande que vive en el mar', answer: 'BALLENA' },
                { type: 'contains', question: 'Contiene I: Ciencia que estudia los n√∫meros y las formas', answer: 'MATEM√ÅTICAS' },
                { type: 'contains', question: 'Contiene I: Animal con ocho patas que teje telara√±as', answer: 'ARA√ëA' },
                { type: 'contains', question: 'Contiene I: Acci√≥n de leer', answer: 'LECTURA' }
            ],
            'J': [
                { type: 'starts', question: 'Deporte de combate de origen japon√©s', answer: 'JUDO' },
                { type: 'starts', question: 'Piedra preciosa de color verde', answer: 'JADE' },
                { type: 'starts', question: 'Persona que imparte justicia en un tribunal', answer: 'JUEZ' },
                { type: 'contains', question: 'Contiene J: Recipiente para l√≠quidos con asa y vertedor', answer: 'JARRA' },
                { type: 'contains', question: 'Contiene J: Peque√±o insecto que salta y pica', answer: 'PULGA' },
                { type: 'contains', question: 'Contiene J: Deporte que se practica en la nieve con esqu√≠s', answer: 'ESQUIAJE' }
            ],
            'K': [
                { type: 'starts', question: 'Deporte japon√©s de arte marcial con patadas y pu√±etazos', answer: 'KARATE' },
                { type: 'starts', question: 'Fruta de piel marr√≥n y carne verde', answer: 'KIWI' },
                { type: 'starts', question: 'Unidad de medida de peso equivalente a mil gramos', answer: 'KILO' },
                { type: 'contains', question: 'Contiene K: Postre helado popular', answer: 'CUPCAKE' },
                { type: 'contains', question: 'Contiene K: Nombre de una famosa mu√±eca', answer: 'BARBIE' },
                { type: 'contains', question: 'Contiene K: Bebida refrescante de cola', answer: 'PEPSI' }
            ],
            'L': [
                { type: 'starts', question: 'Animal de la selva con melena, rey de la sabana', answer: 'LE√ìN' },
                { type: 'starts', question: 'Prenda de vestir para las piernas', answer: 'PANTAL√ìN' },
                { type: 'starts', question: 'Metal precioso de color amarillo', answer: 'ORO' },
                { type: 'contains', question: 'Contiene L: Instrumento para ver de cerca objetos lejanos', answer: 'TELESCOPIO' },
                { type: 'contains', question: 'Contiene L: Utensilio para comer la sopa', answer: 'CUCHARA' },
                { type: 'contains', question: 'Contiene L: Prenda para dormir', answer: 'PIJAMA' }
            ],
            'M': [
                { type: 'starts', question: 'Fruta redonda y roja, muy com√∫n', answer: 'MANZANA' },
                { type: 'starts', question: 'Animal con alas que produce miel', answer: 'ABEJA' },
                { type: 'starts', question: 'Instrumento para escribir o dibujar con grafito', answer: 'L√ÅPIZ' },
                { type: 'contains', question: 'Contiene M: Medio de transporte que se mueve por v√≠as', answer: 'TREN' },
                { type: 'contains', question: 'Contiene M: Prenda de vestir para el fr√≠o', answer: 'ABRIGO' },
                { type: 'contains', question: 'Contiene M: Pieza de mobiliario para sentarse', answer: 'SILLA' }
            ],
            'N': [
                { type: 'starts', question: 'El n√∫mero cero', answer: 'NADA' },
                { type: 'starts', question: 'Color del cielo por la noche', answer: 'NEGRO' },
                { type: 'starts', question: '√ìrgano sensorial para oler', answer: 'NARIZ' },
                { type: 'contains', question: 'Contiene N: Animal que vive en el polo norte y come peces', answer: 'OSO POLAR' },
                { type: 'contains', question: 'Contiene N: Parte del d√≠a donde se duerme', answer: 'NOCHE' },
                { type: 'contains', question: 'Contiene N: Que no tiene luz', answer: 'OSCURO' }
            ],
            '√ë': [
                { type: 'starts', question: 'Peque√±o roedor que vive en la tierra, similar a una rata', answer: '√ëEQUE' },
                { type: 'starts', question: 'Panal o colmena de abejas en un √°rbol', answer: '√ëIRE' },
                { type: 'contains', question: 'Contiene √ë: Planta con hojas espinosas y flores moradas', answer: 'CARDENCHA' },
                { type: 'contains', question: 'Contiene √ë: Peque√±a elevaci√≥n del terreno', answer: 'MONTA√ëA' },
                { type: 'contains', question: 'Contiene √ë: Que tiene mucho sue√±o', answer: 'SO√ëOLIENTO' }
            ],
            'O': [
                { type: 'starts', question: 'Animal grande y peludo, que hiberna en invierno', answer: 'OSO' },
                { type: 'starts', question: 'Sin√≥nimo de "mirar"', answer: 'OBSERVAR' },
                { type: 'starts', question: 'Metal precioso de color amarillo', answer: 'ORO' },
                { type: 'contains', question: 'Contiene O: Parte del cuerpo que usamos para escuchar', answer: 'OREJA' },
                { type: 'contains', question: 'Contiene O: Prenda de vestir para el cuello', answer: 'PA√ëUELO' },
                { type: 'contains', question: 'Contiene O: Objeto que se lanza y vuelve', answer: 'BUMER√ÅN' }
            ],
            'P': [
                { type: 'starts', question: 'Animal dom√©stico que ladra', answer: 'PERRO' },
                { type: 'starts', question: 'Fruto del manzano', answer: 'MANZANA' },
                { type: 'starts', question: 'Color de la sangre', answer: 'ROJO' },
                { type: 'contains', question: 'Contiene P: Instrumento musical de teclado y cuerdas percutidas', answer: 'PIANO' },
                { type: 'contains', question: 'Contiene P: Conjunto de monta√±as', answer: 'PAISAJE' },
                { type: 'contains', question: 'Contiene P: Deporte que se juega en una piscina', answer: 'NATACI√ìN' }
            ],
            'Q': [
                { type: 'starts', question: 'Alimento l√°cteo s√≥lido que se obtiene de la leche', answer: 'QUESO' },
                { type: 'starts', question: 'Mam√≠fero roedor de cola larga', answer: 'QUIMERA' },
                { type: 'starts', question: 'Planta con tronco le√±oso, ramas y hojas', answer: '√ÅRBOL' },
                { type: 'contains', question: 'Contiene Q: Que es muy r√°pido', answer: 'R√ÅPIDO' },
                { type: 'contains', question: 'Contiene Q: Que es muy suave al tacto', answer: 'TERCIOPELO' },
                { type: 'contains', question: 'Contiene Q: Sin√≥nimo de "cantidad"', answer: 'PORCI√ìN' }
            ],
            'R': [
                { type: 'starts', question: 'Animal roedor de tama√±o medio, a menudo considerado plaga', answer: 'RATA' },
                { type: 'starts', question: 'Color de la sangre', answer: 'ROJO' },
                { type: 'starts', question: 'Aparato que sirve para escuchar la radio', answer: 'RADIO' },
                { type: 'contains', question: 'Contiene R: Medio de transporte que vuela', answer: 'AVI√ìN' },
                { type: 'contains', question: 'Contiene R: Parte de la casa donde se duerme', answer: 'DORMITORIO' },
                { type: 'contains', question: 'Contiene R: Que tiene mucho sabor', answer: 'SABROSO' }
            ],
            'S': [
                { type: 'starts', question: 'Astro rey, fuente de luz y calor', answer: 'SOL' },
                { type: 'starts', question: 'Asiento con respaldo y, a veces, brazos', answer: 'SILLA' },
                { type: 'starts', question: 'D√≠a de la semana despu√©s del viernes', answer: 'S√ÅBADO' },
                { type: 'contains', question: 'Contiene S: Nombre del mes despu√©s de agosto', answer: 'SEPTIEMBRE' },
                { type: 'contains', question: 'Contiene S: Prenda de vestir que cubre el pie', answer: 'CALCET√çN' },
                { type: 'contains', question: 'Contiene S: Animal que vive en el agua y tiene escamas', answer: 'PEZ' }
            ],
            'T': [
                { type: 'starts', question: 'Medio de transporte con alas que vuela', answer: 'AVI√ìN' },
                { type: 'starts', question: 'Fruta de color rojo, dulce y jugosa', answer: 'FRESA' },
                { type: 'starts', question: 'Objeto con n√∫meros para ver la hora', answer: 'RELOJ' },
                { type: 'contains', question: 'Contiene T: Aparato para comunicarse a distancia usando voz', answer: 'TEL√âFONO' },
                { type: 'contains', question: 'Contiene T: Deporte que se juega con una red y una pelota', answer: 'TENIS' },
                { type: 'contains', question: 'Contiene T: Lugar donde se hacen obras de teatro', answer: 'TEATRO' }
            ],
            'U': [
                { type: 'starts', question: 'Fruto de la vid, que crece en racimos', answer: 'UVA' },
                { type: 'starts', question: 'Unidad de medida de tiempo equivalente a sesenta segundos', answer: 'MINUTO' },
                { type: 'starts', question: 'Parte del dedo donde crece la u√±a', answer: 'DEDO' },
                { type: 'contains', question: 'Contiene U: Instrumento musical de cuerda, parecido a una guitarra peque√±a', answer: 'UKULELE' },
                { type: 'contains', question: 'Contiene U: Pa√≠s de Am√©rica del Sur famoso por el tango', answer: 'URUGUAY' },
                { type: 'contains', question: 'Contiene U: Un tipo de fruta tropical dulce', answer: 'CASTA√ëA' }
            ],
            'V': [
                { type: 'starts', question: 'Medio de transporte con motor y dos ruedas', answer: 'MOTO' },
                { type: 'starts', question: 'Color de la hierba', answer: 'VERDE' },
                { type: 'starts', question: 'Abertura en la pared para ver el exterior', answer: 'VENTANA' },
                { type: 'contains', question: 'Contiene V: L√≠quido que beben las plantas', answer: 'AGUA' },
                { type: 'contains', question: 'Contiene V: Prenda de vestir que cubre el cuerpo', answer: 'VESTIDO' },
                { type: 'contains', question: 'Contiene V: Mam√≠fero volador de h√°bitos nocturnos', answer: 'MURCI√âLAGO' }
            ],
            'W': [
                { type: 'starts', question: 'Unidad de potencia el√©ctrica', answer: 'WATT' },
                { type: 'starts', question: 'Deporte acu√°tico que se practica con una tabla y una vela', answer: 'WINDSURF' },
                { type: 'contains', question: 'Contiene W: Plataforma de contenido en internet', answer: 'WEB' },
                { type: 'contains', question: 'Contiene W: Un tipo de postre fr√≠o, a menudo con chocolate', answer: 'BROWNIE' },
                { type: 'contains', question: 'Contiene W: Sistema operativo de Microsoft', answer: 'WINDOWS' }
            ],
            'X': [
                { type: 'starts', question: 'Instrumento musical de percusi√≥n con l√°minas de madera', answer: 'XIL√ìFONO' },
                { type: 'starts', question: 'Raza de perro de origen mexicano, sin pelo', answer: 'XOLOITZCUINTLE' },
                { type: 'contains', question: 'Contiene X: Expresi√≥n de alegr√≠a o sorpresa', answer: '√âXITO' },
                { type: 'contains', question: 'Contiene X: Que es de gran tama√±o o extensi√≥n', answer: 'MAXIMO' },
                { type: 'contains', question: 'Contiene X: Un tipo de examen m√©dico de im√°genes', answer: 'RAYOS X' }
            ],
            'Y': [
                { type: 'starts', question: 'L√°cteo fermentado, a menudo con frutas', answer: 'YOGUR' },
                { type: 'starts', question: 'Embarcaci√≥n de recreo de gran tama√±o', answer: 'YATE' },
                { type: 'starts', question: 'Instrumento agr√≠cola para labrar la tierra', answer: 'YANTA' },
                { type: 'contains', question: 'Contiene Y: Bebida caliente y estimulante', answer: 'MATE' },
                { type: 'contains', question: 'Contiene Y: Tipo de animal de granja, hembra del toro', answer: 'BUEY' },
                { type: 'contains', question: 'Contiene Y: Tipo de deporte o ejercicio que busca la relajaci√≥n', answer: 'YOGA' }
            ],
            'Z': [
                { type: 'starts', question: 'Animal de la sabana africana con rayas blancas y negras', answer: 'CEBRA' },
                { type: 'starts', question: 'Calzado que cubre el pie hasta el tobillo o m√°s arriba', answer: 'ZAPATO' },
                { type: 'starts', question: 'Parte de la planta que crece bajo tierra', answer: 'RA√çZ' },
                { type: 'contains', question: 'Contiene Z: Fruta c√≠trica de color naranja', answer: 'NARANJA' },
                { type: 'contains', question: 'Contiene Z: Que est√° muy sucio', answer: 'ASQUEROSO' },
                { type: 'contains', question: 'Contiene Z: Que tiene mucha pereza', answer: 'VAGO' }
            ]
        };


        const letters = Object.keys(questionBank);
        let currentQuestion = null; // La pregunta actual
        let currentLetterElement = null; // El elemento de la letra actual en el rosco

        // Elementos del DOM
        const setupScreen = document.getElementById('setupScreen');
        const countdownScreen = document.getElementById('countdownScreen');
        const gameScreen = document.getElementById('gameScreen');
        const resultsScreen = document.getElementById('resultsScreen');
        const setupForm = document.getElementById('setupForm');
        const playerNameInput = document.getElementById('playerName');
        const gameTimeInput = document.getElementById('gameTime');
        const countdownNumber = document.getElementById('countdownNumber');
        const playerNameDisplay = document.getElementById('playerNameDisplay');
        const timerDisplay = document.getElementById('timer');
        const roscoContainer = document.getElementById('rosco');
        const currentLetterBig = document.getElementById('currentLetterBig');
        const hostQuestionDisplay = document.getElementById('hostQuestionDisplay'); // Nuevo elemento para la pregunta
        const questionTypeDisplay = document.getElementById('questionType');
        const correctAnswerDisplay = document.getElementById('correctAnswer');
        const correctBtn = document.getElementById('correctBtn');
        const incorrectBtn = document.getElementById('incorrectBtn');
        const pasapalabraBtn = document.getElementById('pasapalabraBtn');
        const correctCountDisplay = document.getElementById('correctCount');
        const incorrectCountDisplay = document.getElementById('incorrectCount');
        const pasapalabraCountDisplay = document.getElementById('pasapalabraCount');
        const pauseBtn = document.getElementById('pauseBtn');
        const restartBtn = document.getElementById('restartBtn');
        const pauseModal = document.getElementById('pauseModal');
        const wrongAnswerDisplay = document.getElementById('wrongAnswerDisplay');
        const resumeBtn = document.getElementById('resumeBtn');
        const finalPlayerName = document.getElementById('finalPlayerName');
        const finalCorrect = document.getElementById('finalCorrect');
        const finalIncorrect = document.getElementById('finalIncorrect');
        const finalPasapalabra = document.getElementById('finalPasapalabra');
        const finalTime = document.getElementById('finalTime');


        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', initializeSetup);

        function initializeSetup() {
            setupScreen.style.display = 'flex';
            gameScreen.style.display = 'none';
            countdownScreen.style.display = 'none';
            resultsScreen.style.display = 'none';
            setupEventListeners();
            createRosco();
        }

        function setupEventListeners() {
            setupForm.addEventListener('submit', (e) => {
                e.preventDefault();
                gameConfig.playerName = playerNameInput.value;
                gameConfig.gameTime = parseInt(gameTimeInput.value);
                gameState.timeLeft = gameConfig.gameTime; // Resetear el tiempo aqu√≠
                startCountdown();
            });

            correctBtn.addEventListener('click', () => markAnswer('correct'));
            incorrectBtn.addEventListener('click', () => markAnswer('incorrect'));
            pasapalabraBtn.addEventListener('click', () => markAnswer('pasapalabra'));
            pauseBtn.addEventListener('click', togglePause);
            restartBtn.addEventListener('click', restartGame);
            resumeBtn.addEventListener('click', resumeGame);
        }

        function createRosco() {
            roscoContainer.innerHTML = ''; // Limpiar rosco existente
            const numLetters = letters.length;
            const radius = roscoContainer.offsetWidth / 2 - 30; // Ajustar radio para que quepan las letras

            letters.forEach((letter, index) => {
                const angle = (index / numLetters) * 2 * Math.PI - (Math.PI / 2); // Empezar desde arriba
                const x = radius * Math.cos(angle);
                const y = radius * Math.sin(angle);

                const letterDiv = document.createElement('div');
                letterDiv.classList.add('letter');
                letterDiv.id = `letter-${letter}`;
                letterDiv.textContent = letter;
                letterDiv.style.left = `calc(50% + ${x}px - 25px)`; // 25px = half of letter width
                letterDiv.style.top = `calc(50% + ${y}px - 25px)`; // 25px = half of letter height
                roscoContainer.appendChild(letterDiv);

                // Inicializar estado de las respuestas
                gameState.answers[letter] = {
                    question: '',
                    correctAnswer: '',
                    status: 'pending',
                    type: ''
                };
            });
            window.addEventListener('resize', debounce(updateRoscoPosition, 200));
        }

        function updateRoscoPosition() {
            const numLetters = letters.length;
            const radius = roscoContainer.offsetWidth / 2 - 30; // Re-calcular radio

            letters.forEach((letter, index) => {
                const angle = (index / numLetters) * 2 * Math.PI - (Math.PI / 2);
                const x = radius * Math.cos(angle);
                const y = radius * Math.sin(angle);

                const letterDiv = document.getElementById(`letter-${letter}`);
                if (letterDiv) {
                    letterDiv.style.left = `calc(50% + ${x}px - 25px)`;
                    letterDiv.style.top = `calc(50% + ${y}px - 25px)`;
                }
            });
        }

        function debounce(func, delay) {
            let timeout;
            return function(...args) {
                const context = this;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), delay);
            };
        }

        function selectRandomQuestion(letter) {
            const availableQuestions = questionBank[letter].filter(q =>
                !gameState.usedQuestions.has(`${letter}-${q.question}`)
            );

            if (availableQuestions.length === 0) {
                // Si no hay preguntas no usadas, reiniciar el pool para esta letra
                gameState.usedQuestions = new Set();
                return questionBank[letter][Math.floor(Math.random() * questionBank[letter].length)];
            }

            const randomIndex = Math.floor(Math.random() * availableQuestions.length);
            const question = availableQuestions[randomIndex];
            gameState.usedQuestions.add(`${letter}-${question.question}`);
            return question;
        }

        function startCountdown() {
            setupScreen.style.display = 'none';
            countdownScreen.style.display = 'flex';
            let count = 3;
            countdownNumber.textContent = count;

            const countdownInterval = setInterval(() => {
                count--;
                countdownNumber.textContent = count;
                if (count <= 0) {
                    clearInterval(countdownInterval);
                    startGame();
                }
            }, 1000);
        }

        function startGame() {
            countdownScreen.style.display = 'none';
            gameScreen.style.display = 'flex';
            playerNameDisplay.textContent = gameConfig.playerName;
            timerDisplay.textContent = gameState.timeLeft;

            // Seleccionar una pregunta para cada letra al inicio del juego
            letters.forEach(letter => {
                const q = selectRandomQuestion(letter);
                gameState.answers[letter].question = q.question;
                gameState.answers[letter].correctAnswer = q.answer;
                gameState.answers[letter].type = q.type; // Guardar el tipo de pregunta
            });

            gameState.gameStarted = true;
            gameState.gameEnded = false;
            gameState.gamePaused = false;
            gameState.currentLetter = 0; // Siempre empezar por la 'A'

            startTimer();
            showCurrentQuestion();
            enableHostControls();
            updateStats();
            restartBtn.style.display = 'inline-block';
        }

        function showCurrentQuestion() {
            if (currentLetterElement) {
                currentLetterElement.classList.remove('current');
            }

            // Saltar letras ya respondidas
            while (gameState.currentLetter < letters.length && gameState.answers[letters[gameState.currentLetter]].status !== 'pending') {
                gameState.currentLetter++;
            }

            if (gameState.currentLetter >= letters.length) {
                endGame();
                return;
            }

            const letter = letters[gameState.currentLetter];
            currentLetterElement = document.getElementById(`letter-${letter}`);
            currentLetterElement.classList.add('current');
            currentLetterBig.textContent = letter;

            const currentAnswer = gameState.answers[letter];
            let questionPrefix = '';
            if (currentAnswer.type === 'starts') {
                questionPrefix = `${letter}: `;
            } else if (currentAnswer.type === 'contains') {
                questionPrefix = `Contiene ${letter}: `;
            }
            // Mostrar la pregunta en el nuevo div en el panel del anfitri√≥n
            hostQuestionDisplay.textContent = questionPrefix + currentAnswer.question;
            correctAnswerDisplay.textContent = currentAnswer.correctAnswer;
            questionTypeDisplay.textContent = currentAnswer.type === 'starts' ? 'Empieza por la letra' : 'Contiene la letra';

            updateRoscoDisplay();
        }


        function updateRoscoDisplay() {
            letters.forEach(letter => {
                const letterDiv = document.getElementById(`letter-${letter}`);
                if (letterDiv) {
                    letterDiv.classList.remove('correct', 'incorrect', 'pasapalabra', 'current');
                    const status = gameState.answers[letter].status;
                    if (status !== 'pending') {
                        letterDiv.classList.add(status);
                    }
                }
            });

            // Asegurarse de que la letra actual siempre tenga la clase 'current'
            if (gameState.gameStarted && !gameState.gameEnded && !gameState.gamePaused) {
                const currentLetter = letters[gameState.currentLetter];
                const currentLetterDiv = document.getElementById(`letter-${currentLetter}`);
                if (currentLetterDiv) {
                    currentLetterDiv.classList.add('current');
                }
            }
        }

        function markAnswer(type) {
            if (!gameState.gameStarted || gameState.gameEnded || gameState.gamePaused) return;

            const letter = letters[gameState.currentLetter];
            gameState.answers[letter].status = type;

            if (type === 'correct') {
                gameState.stats.correct++;
            } else if (type === 'incorrect') {
                gameState.stats.incorrect++;
                pauseGameForIncorrect(letter);
                return; // No avanzar a la siguiente pregunta de inmediato
            } else if (type === 'pasapalabra') {
                gameState.stats.pasapalabra++;
            }

            updateStats();
            nextQuestion();
        }

        function pauseGameForIncorrect(letter) {
            togglePause(); // Pausar el juego y el temporizador
            wrongAnswerDisplay.textContent = gameState.answers[letter].correctAnswer;
            pauseModal.style.display = 'flex';
            disableHostControls(); // Deshabilitar controles del anfitri√≥n
        }

        function resumeGame() {
            pauseModal.style.display = 'none';
            togglePause(); // Reanudar el juego y el temporizador
            enableHostControls(); // Habilitar controles del anfitri√≥n
            nextQuestion(); // Pasar a la siguiente pregunta despu√©s de la pausa
        }


        function togglePause() {
            gameState.gamePaused = !gameState.gamePaused;
            if (gameState.gamePaused) {
                clearInterval(gameState.timer);
                pauseBtn.textContent = '‚ñ∂ REANUDAR';
                timerDisplay.classList.add('paused');
                disableHostControls();
            } else {
                startTimer();
                pauseBtn.textContent = '‚è∏ PAUSA';
                timerDisplay.classList.remove('paused');
                enableHostControls();
            }
        }

        function restartGame() {
            if (confirm('¬øEst√°s seguro de que quieres reiniciar el juego? Se perder√° el progreso actual.')) {
                clearInterval(gameState.timer);
                gameState = {
                    currentLetter: 0,
                    timeLeft: gameConfig.gameTime, // Resetear a tiempo inicial
                    timer: null,
                    gameStarted: false,
                    gameEnded: false,
                    gamePaused: false,
                    stats: {
                        correct: 0,
                        incorrect: 0,
                        pasapalabra: 0
                    },
                    answers: {},
                    usedQuestions: new Set()
                };
                initializeSetup(); // Volver a la pantalla de configuraci√≥n
                timerDisplay.classList.remove('warning', 'paused'); // Limpiar clases del timer
                pauseBtn.textContent = '‚è∏ PAUSA'; // Resetear texto del bot√≥n
                restartBtn.style.display = 'none'; // Ocultar el bot√≥n de reiniciar hasta que el juego empiece
            }
        }

        function nextQuestion() {
            updateRoscoDisplay(); // Actualizar el color de la letra anterior

            let allAnswered = true;
            for (let i = 0; i < letters.length; i++) {
                if (gameState.answers[letters[i]].status === 'pending') {
                    allAnswered = false;
                    break;
                }
            }

            if (allAnswered) {
                endGame();
                return;
            }

            // Buscar la siguiente letra pendiente desde la actual + 1
            let nextPendingLetter = -1;
            for (let i = 1; i <= letters.length; i++) {
                const nextIndex = (gameState.currentLetter + i) % letters.length;
                if (gameState.answers[letters[nextIndex]].status === 'pending') {
                    nextPendingLetter = nextIndex;
                    break;
                }
            }

            if (nextPendingLetter !== -1) {
                gameState.currentLetter = nextPendingLetter;
                showCurrentQuestion();
            } else {
                // Esto no deber√≠a pasar si allAnswered es falso, pero como fallback
                endGame();
            }
        }


        function enableHostControls() {
            correctBtn.disabled = false;
            incorrectBtn.disabled = false;
            pasapalabraBtn.disabled = false;
        }

        function disableHostControls() {
            correctBtn.disabled = true;
            incorrectBtn.disabled = true;
            pasapalabraBtn.disabled = true;
        }

        function updateStats() {
            correctCountDisplay.textContent = gameState.stats.correct;
            incorrectCountDisplay.textContent = gameState.stats.incorrect;
            pasapalabraCountDisplay.textContent = gameState.stats.pasapalabra;
        }

        function startTimer() {
            if (gameState.timer) clearInterval(gameState.timer); // Limpiar timer previo si existe
            timerDisplay.textContent = gameState.timeLeft;
            timerDisplay.classList.remove('warning', 'paused');

            gameState.timer = setInterval(() => {
                if (!gameState.gamePaused && gameState.gameStarted && !gameState.gameEnded) {
                    gameState.timeLeft--;
                    timerDisplay.textContent = gameState.timeLeft;

                    if (gameState.timeLeft <= 10 && gameState.timeLeft > 0) {
                        timerDisplay.classList.add('warning');
                    } else if (gameState.timeLeft <= 0) {
                        clearInterval(gameState.timer);
                        endGame();
                    } else {
                        timerDisplay.classList.remove('warning');
                    }
                }
            }, 1000);
        }

        function endGame() {
            if (gameState.gameEnded) return; // Evitar llamadas m√∫ltiples
            gameState.gameEnded = true;
            clearInterval(gameState.timer);
            disableHostControls();
            pauseBtn.disabled = true; // Deshabilitar bot√≥n de pausa al finalizar
            alert('¬°Tiempo fuera! El juego ha terminado.'); // O un modal m√°s bonito
            showResults();
        }

        function showResults() {
            gameScreen.style.display = 'none';
            resultsScreen.style.display = 'flex';
            resultsScreen.style.flexDirection = 'column'; /* Asegurar layout de columna */
            resultsScreen.style.alignItems = 'center'; /* Centrar contenido */
            resultsScreen.style.justifyContent = 'center'; /* Centrar contenido */


            finalPlayerName.textContent = gameConfig.playerName;
            finalCorrect.textContent = gameState.stats.correct;
            finalIncorrect.textContent = gameState.stats.incorrect;
            finalPasapalabra.textContent = gameState.stats.pasapalabra;

            const timeUsed = gameConfig.gameTime - gameState.timeLeft;
            finalTime.textContent = timeUsed + 's';

            // Tabla de resultados
            const tableBody = document.getElementById('resultsTableBody');
            tableBody.innerHTML = '';

            letters.forEach(letter => {
                const answer = gameState.answers[letter];
                const row = document.createElement('tr');
                row.className = answer.status;

                const statusText = {
                    'correct': 'Correcta ‚úì',
                    'incorrect': 'Incorrecta ‚úó',
                    'pasapalabra': 'Pasapalabra ‚è≠',
                    'pending': 'Sin responder'
                };

                // Asegurarse de que el tipo de pregunta se muestre correctamente en la tabla
                const typeLabel = answer.type === 'starts' ? `${letter}: ` : `Contiene ${letter}: `;
                const questionWithPrefix = typeLabel + answer.question;


                row.innerHTML = `
                    <td data-label="Letra"><strong>${letter}</strong></td>
                    <td data-label="Tipo" class="question-type-cell">${answer.type === 'starts' ? 'Empieza por' : 'Contiene'}</td>
                    <td data-label="Pregunta">${questionWithPrefix}</td>
                    <td data-label="Respuesta Correcta"><strong>${answer.correctAnswer}</strong></td>
                    <td data-label="Estado">${statusText[answer.status]}</td>
                `;

                tableBody.appendChild(row);
            });
        }
    </script>
</body>
</html>